# Learning systems of Ordinary Differential Equations using standard Symbolic Regression

This repository contains the code and data for a series of works on learning ODE systems (system identification) using symbolic regression. Employing classical symbolic regression on dynamical systems requires applying a data transformation to the trajectory/time series data. Three different data transformations have been proposed in literature:
1. $\Delta_x$, introduced in the seminal 1994 [Genetic Programming book](https://mitpress.mit.edu/9780262527910/genetic-programming/)
2. $F_x$, introduced in the 2014 paper [Learning Dynamical Systems Using Standard Symbolic Regression](https://link.springer.com/chapter/10.1007/978-3-662-44303-3_3)
3. $\mathcal{C}_x$, an approach which also significantly modifies the fitness function, presented in the 2022 paper [D-CODE: Discovering Closed-form ODEs from Observed Trajectories](https://par.nsf.gov/servlets/purl/10357448)

## Testing data transformation approaches
The results reported in the publications below can be reproduced running scripts in Python and Julia. To run the experiments, you will first need to check out the repository using Git, or download it as a .zip file to then unzip it to a folder.

### 1. Performance of ground truth equations
The aim of this first set of experiments is to assess the performance of the ground truth (known) equations that generated the original trajectory data, in the space generated by the transformations. Surprisingly, sometimes in that space the ground truth equation has a poor performance, evaluated with a metric like R2 or mean squared error.  

To evaluate all data transformations, the Python script can be called with:

```
cd utils
python check_odebench_all_transformations.py
```

The results will be saved to a directory named `/local_results/check_odebench_all_transformations` from the root of the local copy of the repository. The directory includes a subdirectory for each test ODE system contained in the ODEBench benchmark suite (63 different test ODE systems at the time of writing). Each subdirectory will include several files, one for each trajectory, each level on added noise, each data transformation, and each combination of hyperparameters for the data transformation.  

The ground truth equations for each ODE systems will then be compared against each trajectory transformed with the three data transformations. To summarize the results in a CSV table called `/local_results/check_odebench_all_transformations/summary.csv`, you will have to run the other script:

```
python create_table_from_experiments.py
```

### 2. Deceptive search spaces for symbolic regression
Even though the performance of the ground truth equation might be poor, this would not be a problem for a symbolic regression algorithm, _iff_ the ground truth still represents a global optimum in the search space (at least for a certain level of complexity, defined as size of the tree).  

However, this is not true: the following experiments show that even a state-of-the-art symbolic regression approach like `PySR` (https://github.com/MilesCranmer/PySR) finds equations with complexity equal or close to the ground truth, but higher performance in the new search space.

## Publications
TONDA A., ZHANG H., CHEN Q., XUE B., ZHANG M., LUTTON E. 2025. When Data Transformations Mislead Symbolic Regression: Deceptive Search Spaces in System Identification, In: Workshop on Symbolic Regression, proceedings of the annual conference on Genetic and evolutionary computation (GECCO) 2025 companion, DOI: 10.1145/3712255.3734301  

TONDA A., ZHANG H., CHEN Q., XUE B., ZHANG M., LUTTON E. 2025. Comparing Data Transformation Techniques for System Identification With Standard Symbolic Regression, In: Proceedings of the annual conference on Genetic and evolutionary computation (GECCO) 2025 companion, DOI: 10.1145/3712255.3726673
